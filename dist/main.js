(()=>{"use strict";var t=new Map([["v_SafeSingleTri","attribute vec3 vertex_position;\nattribute vec3 vertex_color;\nvarying vec3 vColor;\nvoid main() {\ngl_Position = vec4(vertex_position, 1.0);\nvColor = vertex_color;\n}\n"],["f_SafeSingleTriWColor","\n        precision highp float;\n        varying vec3 vColor;\n        void main() {\n            gl_FragColor = vec4(vColor, 1.0);\n        }\n    "],["v_O2W&color","\n        attribute vec3 vertex_position;\n        attribute vec3 vertex_color;\n\n        uniform mat4 objectToWorld;\n\n        varying vec3 vColor;\n        void main() {\n            vec4 vertex = objectToWorld * vec4(vertex_position, 1);\n            gl_Position = vertex;\n            vColor = vertex_color;\n        }\n    "]]),r=function(){function r(t){this.context=t,this.program=t.createProgram()}return r.prototype.attachShaderFromShaderLib=function(r,e){if(!t.has(r))throw"Cannot find shader: ".concat(r," in shader library!");this.attachShaderFromString(t.get(r),e)},r.prototype.attachShaderFromString=function(t,e){var o;switch(e){case r.shaderTypes.VERTEX:o=this.context.VERTEX_SHADER;break;case r.shaderTypes.FRAGMENT:o=this.context.FRAGMENT_SHADER;break;default:throw"Cant implement shadertype: ".concat(e," in func attachShaderFromString!")}var i=this.context.createShader(o);if(this.context.shaderSource(i,t),this.context.compileShader(i),!this.context.getShaderParameter(i,this.context.COMPILE_STATUS)){var n=this.context.getShaderInfoLog(i);throw"Could not compile shader ".concat(e,". \n\n").concat(n)}this.context.attachShader(this.program,i)},r.prototype.useProgram=function(){if(this.context.linkProgram(this.program),!this.context.getProgramParameter(this.program,this.context.LINK_STATUS)){var t=this.context.getProgramInfoLog(this.program);throw"Could not compile WebGL program. \n\n".concat(t)}this.context.useProgram(this.program)},r.prototype.getAttributeLocation=function(t){return this.useProgram(),this.context.getAttribLocation(this.program,t)},r.prototype.getUniformLocation=function(t){return this.useProgram(),this.context.getUniformLocation(this.program,t)},r}();!function(t){var r;(r=t.shaderTypes||(t.shaderTypes={}))[r.VERTEX=0]="VERTEX",r[r.FRAGMENT=1]="FRAGMENT"}(r||(r={}));var e=function(){function t(t){this.canvas=t,this.context=t.getContext("webgl2"),this.shaderProgramHelper=null}return t.prototype.makeSeededProgramWrapper=function(){return new r(this.context)},t.prototype.attachProgramWrapper=function(t){this.shaderProgramHelper=t},t.prototype.buildAndPushArrayBuffer=function(t){var r=this.context.createBuffer();return this.context.bindBuffer(this.context.ARRAY_BUFFER,r),this.context.bufferData(this.context.ARRAY_BUFFER,t,this.context.STATIC_DRAW),this.context.bindBuffer(this.context.ARRAY_BUFFER,null),r},t.prototype.buildAndPushElementArrayBuffer=function(t){var r=this.context.createBuffer();return this.context.bindBuffer(this.context.ELEMENT_ARRAY_BUFFER,r),this.context.bufferData(this.context.ELEMENT_ARRAY_BUFFER,t,this.context.STATIC_DRAW),this.context.bindBuffer(this.context.ELEMENT_ARRAY_BUFFER,null),r},t.prototype.bindAttributeNameToBuffer=function(t,r,e,o,i,n){if(null==this.shaderProgramHelper)throw"No shader program to try and attach attribute ".concat(r," to!");this.context.bindBuffer(this.context.ARRAY_BUFFER,t);var a=this.shaderProgramHelper.getAttributeLocation(r);this.context.vertexAttribPointer(a,e,this.context.FLOAT,o,i,n),this.context.enableVertexAttribArray(a),this.context.bindBuffer(this.context.ARRAY_BUFFER,null)},t.prototype.bindMatrixUniform=function(t,r,e){if(null==this.shaderProgramHelper)throw"No shader program to try and attach uniform ".concat(e," to!");var o=this.shaderProgramHelper.getUniformLocation(e);switch(r){case 2:this.context.uniformMatrix2fv(o,!1,t);break;case 3:this.context.uniformMatrix3fv(o,!1,t);break;case 4:this.context.uniformMatrix4fv(o,!1,t);break;default:throw"Matrix size of ".concat(r," has no gl sibling!")}},t.prototype.draw=function(t,r){this.context.bindBuffer(this.context.ELEMENT_ARRAY_BUFFER,t),this.context.clearColor(0,0,0,1),this.context.enable(this.context.DEPTH_TEST),this.context.clear(this.context.COLOR_BUFFER_BIT),this.context.viewport(0,0,this.canvas.width,this.canvas.height),this.context.drawElements(this.context.TRIANGLES,r,this.context.UNSIGNED_SHORT,0)},t.prototype.getError=function(){return this.context.getError()},t}(),o=function(){function t(){this.TranslationMatrix=t.getIdentity(),this.ScalingMatrix=t.getIdentity(),this.XRotationMatrix=t.getIdentity(),this.YRotationMatrix=t.getIdentity(),this.ZRotationMatrix=t.getIdentity(),this.rotations=[0,0,0]}return t.getIdentity=function(){return[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]},t.prototype.setTranslation=function(r,e,o){var i=t.getIdentity();i[0][3]=r,i[1][3]=e,i[2][3]=o,this.TranslationMatrix=i},t.prototype.getTranslation=function(){return[this.TranslationMatrix[0][3],this.TranslationMatrix[1][3],this.TranslationMatrix[0][2]]},t.prototype.setScaling=function(r,e,o){var i=t.getIdentity();i[0][0]=r,i[1][1]=e,i[2][2]=o,this.ScalingMatrix=i},t.prototype.getScaling=function(){return[this.ScalingMatrix[1][1],this.ScalingMatrix[2][2],this.ScalingMatrix[3][3]]},t.prototype.setRotation=function(t,r,e){this.XRotationMatrix=this.createXRotationMatrix(t),this.YRotationMatrix=this.createYRotationMatrix(r),this.ZRotationMatrix=this.createZRotationMatrix(e),this.rotations=[t,r,e]},t.prototype.getRotation=function(){return this.rotations},t.prototype.computeTransformMatrix=function(){var r;r=t.multiply4x4Matrixes(this.TranslationMatrix,this.XRotationMatrix),r=t.multiply4x4Matrixes(r,this.YRotationMatrix),r=t.multiply4x4Matrixes(r,this.ZRotationMatrix),r=t.multiply4x4Matrixes(r,this.ScalingMatrix);for(var e=new Float32Array(16),o=0;o<4;o++)for(var i=0;i<4;i++)e[o+4*i]=r[o][i];return e},t.multiply4x4Matrixes=function(t,r){for(var e=this.getIdentity(),o=0;o<4;o++)for(var i=0;i<4;i++){e[o][i]=0;for(var n=0;n<4;n++)e[o][i]+=t[o][n]*r[n][i]}return e},t.prototype.createXRotationMatrix=function(r){var e=r*t.r2d,o=Math.cos(e),i=Math.sin(e);return[[1,0,0,0],[0,o,i,0],[0,-i,o,0],[0,0,0,1]]},t.prototype.createYRotationMatrix=function(r){var e=r*t.r2d,o=Math.cos(e),i=Math.sin(e);return[[o,0,i,0],[0,1,0,0],[-i,0,o,0],[0,0,0,1]]},t.prototype.createZRotationMatrix=function(r){var e=r*t.r2d,o=Math.cos(e),i=Math.sin(e);return[[o,i,0,0],[-i,o,0,0],[0,0,1,0],[0,0,0,1]]},t.r2d=Math.PI/180,t}(),i=[0,1,2],n=document.getElementById("screen");n.width=1080,n.height=720;var a=new e(n),s=a.makeSeededProgramWrapper();s.attachShaderFromShaderLib("v_O2W&color",r.shaderTypes.VERTEX),s.attachShaderFromShaderLib("f_SafeSingleTriWColor",r.shaderTypes.FRAGMENT),a.attachProgramWrapper(s);var c=a.buildAndPushArrayBuffer(new Float32Array([-.5,.5,0,-.5,-.5,0,.5,-.5,0])),h=a.buildAndPushArrayBuffer(new Float32Array([0,1,0,0,1,0,0,1,0])),u=a.buildAndPushElementArrayBuffer(new Uint16Array(i));a.bindAttributeNameToBuffer(c,"vertex_position",3,!1,0,0),a.bindAttributeNameToBuffer(h,"vertex_color",3,!1,0,0);var x=0,l=0,f=0,p=new o;setInterval((function(){p.setTranslation(f-.5,f-.5,f-.5),p.setScaling(l,l,l),p.setRotation(x,x,x);var t=p.computeTransformMatrix();console.log(t),a.bindMatrixUniform(t,4,"objectToWorld"),a.draw(u,i.length),x=(x+1)%360,f=(.1+(l=(l+.01)%2))%1,console.log(a.getError()),console.log(l,x,f)}),1e3/60)})();